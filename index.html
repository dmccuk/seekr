<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Seekr.run, Coming soon</title>
  <meta name="description" content="Seekr.run, GPS hide and seek, coming soon" />
  <link rel="icon" type="image/x-icon" href="assets/seekr-favicon.ico" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Leaflet for the live map -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    defer
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <style>
    :root{
      --ink:#0e1220; --muted:#55627a; --bg:#f6f8fc; --card:#ffffff;
      --brand:#1e4cff; --accent:#35c18f; --line:#e7ecf3;
      --tip-bg: rgba(14,18,32,.92); --tip-ink:#fff;
      --good:#1f7a48; --bad:#b00020;
    }
    *{ box-sizing:border-box }
    html, body{ height:100% }
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height:1.35;
    }
    .shell{ max-width:980px; margin:0 auto; padding:40px 16px 80px }
    header{ text-align:center; margin-bottom:22px }
    .brand{ font-weight:800; font-size:20px; letter-spacing:.5px }
    .tag{ display:inline-block; margin-top:6px; font-size:12px; color:var(--muted); font-weight:500 }

    .hero{
      text-align:center; background:var(--card); border:1px solid var(--line);
      border-radius:18px; padding:28px 18px; box-shadow:0 10px 30px rgba(20,32,70,.06);
    }
    h1{ margin:0 0 6px 0; font-size:34px; font-weight:800; letter-spacing:.2px }
    .sub{ color:var(--muted); margin-bottom:16px; font-weight:500 }

    .join{
      display:inline-flex; gap:8px; align-items:center; justify-content:center;
      border:1px solid var(--line); border-radius:12px; padding:8px; background:#fff;
    }
    .join input{ border:0; outline:0; padding:10px 12px; width:180px; font-family:'Poppins', sans-serif }
    .join button{
      border:0; padding:10px 14px; border-radius:10px; font-weight:600;
      background:#26a269; color:#fff; opacity:.45; cursor:not-allowed;
      font-family:'Poppins', sans-serif
    }

    .coming{
      position:relative; /* for tooltip */
      margin:18px auto 6px;
      display:inline-block;
      font-weight:800;
      letter-spacing:.08em;
      color:#ffffff;
      background:linear-gradient(135deg, #ff5e62, #ff9966);
      border:1px solid #ff7e6b;
      border-radius:999px;
      padding:10px 18px;
      box-shadow:0 4px 12px rgba(255, 94, 98, 0.4);
      font-size:14px;
      text-transform:uppercase;
      animation:pulse 1.6s ease-in-out infinite;
      vertical-align:middle;
    }
    /* Tooltip for Coming soon */
    .coming::after{
      content:attr(data-tooltip);
      position:absolute;
      left:50%; bottom:calc(100% + 8px);
      transform:translateX(-50%);
      background:var(--tip-bg); color:var(--tip-ink);
      font-size:12px; line-height:1.4;
      padding:8px 10px; border-radius:8px;
      white-space:normal; width:240px; max-width:90vw; text-align:center;
      opacity:0; pointer-events:none; transition:opacity .2s ease;
      z-index:100;
    }
    .coming:hover::after, .coming:focus-visible::after{ opacity:1 }

    /* Small WhatsApp button next to Coming soon */
    .whatsapp-btn{
      background:#25D366;
      color:#fff;
      border-radius:50%;
      width:36px;
      height:36px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      border:none;
      cursor:pointer;
      box-shadow:0 4px 8px rgba(0,0,0,0.15);
      margin-left:8px;
      vertical-align:middle;
      position:relative;
      top:2px; /* nudges button down */
    }
    .whatsapp-btn:hover{ background:#20b358 }
    .whatsapp-btn svg{ width:18px; height:18px; display:block; fill:currentColor }

    .stage{ display:grid; place-items:center; margin-top:16px }
    .phone{
      position:relative; width:min(420px, 86vw); aspect-ratio:9/19.5;
      background:#111; border-radius:38px; border:10px solid #111;
      box-shadow:0 25px 60px rgba(18,28,60,.25), 0 4px 12px rgba(18,28,60,.12);
      overflow:hidden;
    }
    .phone:before{
      content:""; position:absolute; top:0; left:50%; transform:translateX(-50%);
      width:40%; height:26px; background:#111; border-bottom-left-radius:16px; border-bottom-right-radius:16px;
    }
    .screen{
      position:absolute; inset:10px; border-radius:28px; overflow:hidden; background:#000;
      display:grid; place-items:center;
    }
    .screen video{ display:block; width:100%; height:100%; object-fit:cover; }
    #liveMap{ width:100%; height:100%; display:none; }

    .gpsBtn {
      display: block;
      width: 80%;
      max-width: 280px;
      margin: 16px auto 0;
      padding: 14px 20px;
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.6);
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      color: #ffffff;
      font-weight: 800;
      font-size: 16px;
      text-transform: uppercase;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(79, 172, 254, 0.4);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      animation:pulse 1.6s ease-in-out infinite;
    }
    .gpsBtn:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(79, 172, 254, 0.55); }
    .gpsBtn:active { transform: translateY(0); box-shadow: 0 3px 8px rgba(79, 172, 254, 0.3); }

    /* Reversed gradient for Gameplay demo */
    .demoBtn{
      display:block;
      width:80%;
      max-width:280px;
      margin: 16px auto 0;
      padding: 14px 20px;
      border-radius: 12px;
      border: 2px solid rgba(255, 255, 255, 0.6);
      background: linear-gradient(135deg, #00f2fe, #4facfe);
      color:#fff;
      font-weight:800;
      font-size:16px;
      text-transform:uppercase;
      text-align:center;
      cursor:pointer;
      box-shadow:0 4px 12px rgba(79,172,254,.4);
      transition: transform .15s ease, box-shadow .15s ease;
      text-decoration:none;
    }
    .demoBtn:hover{ transform:translateY(-2px); box-shadow:0 6px 16px rgba(79,172,254,.55) }
    .demoBtn:active{ transform:translateY(0); box-shadow:0 3px 8px rgba(79,172,254,.3) }

    #compatMsg{ margin-top:8px; }

    .limitNote{
      display:none;
      margin:10px auto 0;
      max-width:680px;
      font-size:14px;
      color:var(--muted);
      background:#f1f4fb;
      border:1px solid var(--line);
      border-radius:10px;
      padding:10px 12px;
    }

    .features{
      display:grid; grid-template-columns:1fr 1fr; gap:18px; margin-top:26px;
    }
    .card{
      position:relative;
      background:var(--card); border:1px solid var(--line); border-radius:14px;
      padding:14px 16px;
      transition: box-shadow .2s ease, transform .2s ease;
      cursor:default;
      outline:none;
    }
    .card:hover, .card:focus-visible{ box-shadow:0 8px 22px rgba(20,32,70,.08); transform:translateY(-1px) }
    .card b{ display:block; margin-bottom:4px; font-weight:600 }
    .card small{ color:var(--muted); font-weight:400 }

    .card::after{
      content:attr(data-tooltip);
      position:absolute; left:50%; bottom:calc(100% + 8px); transform:translateX(-50%);
      background:var(--tip-bg); color:var(--tip-ink);
      font-size:12px; line-height:1.4; padding:8px 10px; border-radius:8px;
      white-space:normal; width:240px; max-width:90vw; text-align:center;
      opacity:0; pointer-events:none; transition:opacity .2s ease;
      z-index:100;
    }
    .card:hover::after, .card:focus-visible::after, .card.show-tip::after{ opacity:1 }

    .faq{ margin-top:28px; text-align:left; }
    .faq h2{ margin:8px 0 14px 0; font-size:22px; font-weight:800; text-align:center; }
    details{
      background:var(--card); border:1px solid var(--line); border-radius:14px;
      padding:12px 14px; margin-bottom:10px;
    }
    details[open]{ box-shadow:0 8px 22px rgba(20,32,70,.06) }
    summary{ list-style:none; cursor:pointer; font-weight:600; display:flex; align-items:center; gap:10px; outline:none; }
    summary::-webkit-details-marker{ display:none }
    .chev{ width:18px; height:18px; border:2px solid var(--muted); border-left:0; border-top:0; transform:rotate(-45deg); transition: transform .2s ease, border-color .2s ease; margin-left:auto; }
    details[open] .chev{ transform:rotate(135deg); border-color: var(--ink) }
    .answer{ color:var(--muted); margin-top:8px; line-height:1.55; }

    @media (max-width:720px){
      h1{ font-size:28px }
      .features{ grid-template-columns:1fr }
    }

    .fade-in{ animation:fade .8s ease-out both }
    @keyframes fade{ from{ opacity:0; transform:translateY(6px) } to{ opacity:1; transform:none } }

    /* Pulse animation */
    @keyframes pulse {
      0% { transform: scale(1); box-shadow: 0 0 0 rgba(0, 0, 0, 0.18); }
      50% { transform: scale(1.04); box-shadow: 0 0 12px rgba(0, 0, 0, 0.28); }
      100% { transform: scale(1); box-shadow: 0 0 0 rgba(0, 0, 0, 0.18); }
    }
  </style>
</head>
<body>
  <div class="shell">
    <header>
      <div class="brand">Seekr.run</div>
      <div class="tag">GPS hide and seek</div>
    </header>

    <section class="hero">
      <h1>The classic chase, now at global scale</h1>
      <p class="sub">Run, hide, track, reveal, anywhere on earth, right from your phone.</p>

      <div class="join" aria-disabled="true">
        <input type="text" placeholder="Game code" disabled aria-label="Game code" />
        <button disabled>Join game</button>
      </div>

      <div class="coming" tabindex="0" aria-hidden="false" data-tooltip="Sign up for early access below">Coming soon</div>
      <!-- Small WhatsApp button next to Coming soon -->
      <button id="shareWA" class="whatsapp-btn" title="Share on WhatsApp" aria-label="Share on WhatsApp">
        <!-- inline WhatsApp icon -->
        <svg viewBox="0 0 32 32" aria-hidden="true">
          <path d="M19.11 17.39c-.3-.15-1.77-.87-2.05-.97-.28-.1-.49-.15-.7.15s-.8.97-.98 1.17c-.18.2-.36.22-.66.07-.3-.15-1.28-.47-2.44-1.5-.9-.8-1.52-1.78-1.7-2.08-.18-.3-.02-.46.13-.61.14-.14.3-.36.45-.54.15-.18.2-.3.3-.5.1-.2.05-.37-.02-.52-.07-.15-.7-1.69-.96-2.3-.25-.6-.51-.52-.7-.53l-.6-.01c-.2 0-.52.07-.79.37-.27.3-1.04 1.02-1.04 2.49s1.07 2.89 1.22 3.09c.15.2 2.1 3.2 5.08 4.49.71.31 1.27.5 1.7.64.71.23 1.36.2 1.87.12.57-.09 1.77-.72 2.03-1.42.25-.7.25-1.29.18-1.42-.07-.13-.27-.2-.57-.35zM16 3.1c-7.12 0-12.9 5.78-12.9 12.9 0 2.28.6 4.51 1.75 6.47L3 29l6.74-1.77a12.83 12.83 0 0 0 6.26 1.6c7.12 0 12.9-5.78 12.9-12.9S23.12 3.1 16 3.1zm0 23.36c-2.15 0-4.25-.58-6.08-1.68l-.44-.26-4.02 1.06 1.08-3.92-.28-.45a10.77 10.77 0 1 1 9.74 5.25z" fill="currentColor"/>
        </svg>
      </button>

      <div class="stage">
        <div class="phone fade-in" aria-label="Phone mockup">
          <div class="screen">
            <!-- Fallback video, visible by default -->
            <video id="demoVideo" playsinline autoplay muted loop>
              <source src="assets/seekr.mp4" type="video/mp4" />
            </video>
            <!-- Live map, hidden until GPS permission is granted -->
            <div id="liveMap" role="img" aria-label="Your location on the map"></div>
          </div>
        </div>
      </div>

      <button id="gpsBtn" class="gpsBtn" type="button">Test compatibility</button>
      <p id="compatMsg" class="sub"></p>
      <div id="limitNote" class="limitNote">
        Location works while this page is open and visible, if you close or background the page, updates will pause. For background play we will offer a native app with added permissions.
      </div>

      <!-- Reversed gradient Gameplay demo button -->
      <a href="demo.html" class="demoBtn">Gameplay demo</a>

      <div class="features">
        <div class="card" tabindex="0"
             data-tooltip="Pick any area, for example a park or a campus. Or go global. The host sets the boundary, everyone plays inside it.">
          <b>Play anywhere</b>
          <small>From a 1 mile square park to the whole world, you set the map</small>
        </div>

        <div class="card" tabindex="0"
             data-tooltip="Spend a small balance to delay your next ping, or trigger an instant reveal. Cooldowns keep rounds fair.">
          <b>Power ups</b>
          <small>Delay ping and instant reveal, funded from a small balance</small>
        </div>
      </div>

      <!-- Interest signup -->
      <section class="hero" style="margin-top:22px;">
        <h2 style="margin:0 0 8px 0; font-size:22px; font-weight:800;">Get early access</h2>
        <p class="sub" style="margin:0 0 14px 0;">Register your interest, we will email you when Seekr.run opens.</p>

        <form id="interestForm" action="https://formspree.io/f/mqalnlka" method="POST"
              class="join" style="flex-wrap:wrap; gap:10px;">
          <input type="email" name="email" autocomplete="email"
                 placeholder="Your email" aria-label="Your email"
                 required style="width:220px;">

          <label style="width:100%; display:flex; align-items:center; gap:8px; font-size:12px; color:var(--muted);">
            <input type="checkbox" name="consent" required>
            I agree to receive early access updates about Seekr.run
          </label>

          <!-- honeypot field to block spam -->
          <input type="text" name="extra_field" tabindex="-1" autocomplete="off"
                 aria-hidden="true"
                 style="position:absolute; left:-9999px; width:1px; height:1px; opacity:0;">

          <button id="btnRegister" type="submit" style="opacity:1; cursor:pointer;">Notify me</button>

          <small id="formMsg" style="width:100%; text-align:center; color:#1f7a48; display:none;"></small>
        </form>

        <small class="sub" style="display:block; margin-top:10px;">
          We will only use your email for Seekr.run updates, you can opt out any time.
        </small>
      </section>

      <!-- FAQ -->
      <section class="faq" aria-label="Frequently asked questions">
        <h2>FAQ</h2>

        <details>
          <summary>How do I set up a game?<span class="chev"></span></summary>
          <div class="answer">Pick a game area, share a code with friends, then choose who is seeker and who is hider. Everything runs in the browser.</div>
        </details>

        <details>
          <summary>Is it free to play?<span class="chev"></span></summary>
          <div class="answer">Yes. Games are free. Optional power ups cost a small amount if you want extra strategy.</div>
        </details>

        <details>
          <summary>Do I need an app?<span class="chev"></span></summary>
          <div class="answer">No app needed. Visit the site on iPhone or Android, enter the code, and play.</div>
        </details>

        <details>
          <summary>How does the seeker find hiders?<span class="chev"></span></summary>
          <div class="answer">Hider locations appear on the map at set intervals. The seeker uses those pings to close in.</div>
        </details>

        <details>
          <summary>How do I win?<span class="chev"></span></summary>
          <div class="answer">Hiders win by staying untagged until the end. The seeker wins by tagging every hider before time is up.</div>
        </details>

        <details>
          <summary>How is tagging detected?<span class="chev"></span></summary>
          <div class="answer">When players are within a set GPS distance, for example 5 to 10 meters, the game registers a tag automatically.</div>
        </details>

        <details>
          <summary>How accurate is GPS?<span class="chev"></span></summary>
          <div class="answer">Outdoors, accuracy is usually within a few meters. In dense areas it may drift a bit. Open spaces work best.</div>
        </details>

        <details>
          <summary>What are power ups exactly?<span class="chev"></span></summary>
          <div class="answer">Delay Ping lets you pause your next reveal. Instant Reveal shows hiders right now. Limits and cooldowns keep it fair.</div>
        </details>

        <details>
          <summary>Can we set our own rules?<span class="chev"></span></summary>
          <div class="answer">Yes. The host can set duration, reveal timing, tag distance, and which power ups are allowed.</div>
        </details>

        <details>
          <summary>Is it safe?<span class="chev"></span></summary>
          <div class="answer">Play in safe areas, respect property and local laws, and keep an eye on your surroundings. Hider reveals include a small privacy offset.</div>
        </details>

        <!-- Optional, out of bounds question
        <details>
          <summary>What happens if I go out of bounds?<span class="chev"></span></summary>
          <div class="answer">
            If you leave the set game area, you will get a warning and a short grace period to return.
            If you stay outside the boundary past that time, you may be disqualified for that round.
          </div>
        </details>
        -->
      </section>
    </section>
  </div>

  <!-- Interest form script -->
  <script>
    // Inline success and error message handler
    const form = document.getElementById('interestForm');
    const msg = document.getElementById('formMsg');
    const registerBtn = document.getElementById('btnRegister'); // renamed to avoid clash

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.style.display = 'none';
      registerBtn.disabled = true;
      registerBtn.textContent = 'Sending...';

      try{
        const data = new FormData(form);
        if(!data.get('email') || !data.get('consent')) {
          throw new Error('Please enter your email and consent');
        }

        const resp = await fetch(form.action, {
          method: 'POST',
          headers: { 'Accept': 'application/json' },
          body: data
        });

        if(resp.ok){
          form.reset();
          msg.textContent = 'Thanks, you are on the list. Check your inbox.';
          msg.style.color = '#1f7a48';
          msg.style.display = 'block';
        }else{
          const err = await resp.json().catch(()=>({}));
          throw new Error(err.error || 'Submission failed, please try again later');
        }
      }catch(err){
        msg.textContent = err.message || 'Something went wrong';
        msg.style.color = '#b00020';
        msg.style.display = 'block';
      }finally{
        registerBtn.disabled = false;
        registerBtn.textContent = 'Notify me';
      }
    });
  </script>

  <!-- GPS compatibility script -->
  <script>
    // Tooltips on tap for mobile
    document.querySelectorAll('.card').forEach(el => {
      el.addEventListener('click', () => {
        el.classList.add('show-tip');
        clearTimeout(el._tipTimer);
        el._tipTimer = setTimeout(() => el.classList.remove('show-tip'), 2200);
      });
      el.addEventListener('blur', () => el.classList.remove('show-tip'));
    });

    // Compatibility test, GPS to Live Map, fallback to MP4
    const gpsBtn = document.getElementById('gpsBtn'); // distinct name
    const compatMsg = document.getElementById('compatMsg');
    const limitNote = document.getElementById('limitNote');
    const videoEl = document.getElementById('demoVideo');
    const mapEl = document.getElementById('liveMap');

    let map, me;

    function say(t, ok = true){
      compatMsg.textContent = t;
      compatMsg.style.color = ok ? 'var(--good)' : 'var(--bad)';
    }

    async function tryWakeLock(){
      if ('wakeLock' in navigator) {
        try { await navigator.wakeLock.request('screen'); return true; }
        catch { return false; }
      }
      return false;
    }

    function enableMap(lat, lng){
      if(videoEl){ videoEl.pause(); videoEl.style.display = 'none'; }
      mapEl.style.display = 'block';
      if(!map){
        map = L.map('liveMap', { zoomControl:false, attributionControl:false });
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);
      }
      map.setView([lat, lng], 16);
      if(!me){
        me = L.circleMarker([lat, lng], { radius:8, weight:3, color:'#1e4cff', fillColor:'#1e4cff', fillOpacity:.35 }).addTo(map);
      }else{
        me.setLatLng([lat, lng]);
      }
    }

    gpsBtn.addEventListener('click', async () => {
      if (location.protocol !== 'https:') {
        say('This test needs HTTPS. GitHub Pages or your custom domain will work.', false);
        return;
      }
      if (!('geolocation' in navigator)) {
        say('Geolocation is not available in this browser.', false);
        return;
      }

      const gotWake = await tryWakeLock();
      if (gotWake) { say('Wake lock granted, testing GPS...'); }
      else { say('Testing GPS. Tip, keep the screen on for best results.'); }

      navigator.geolocation.getCurrentPosition(pos => {
        enableMap(pos.coords.latitude, pos.coords.longitude);
        navigator.geolocation.watchPosition(p => {
          enableMap(p.coords.latitude, p.coords.longitude);
        }, () => {}, { enableHighAccuracy:true, maximumAge:5000, timeout:15000 });
        say('Looks good. Your device can play Seekr in the browser.');
        limitNote.style.display = 'block';
      }, err => {
        say('We could not get your location. You can still watch the demo video.', false);
        console.warn(err);
        limitNote.style.display = 'block';
      }, { enableHighAccuracy:true, maximumAge:0, timeout:15000 });
    });
  </script>

  <!-- WhatsApp share script -->
  <script>
    document.getElementById('shareWA').addEventListener('click', () => {
      const text = "Check out Seekr.run, GPS hide and seek at global scale! " + window.location.href;
      const url = "https://wa.me/?text=" + encodeURIComponent(text);
      window.open(url, "_blank");
    });
  </script>
</body>
</html>
